<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      
      
    <title>Music Composition LSTM Recurrent Neural Networks</title>
    <link rel="stylesheet" type="text/css" href="main.css"/>
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
  </head>
<body>
    <header class="container">
        <div id="headline" class="row text-center">
            <h1 class="col-sm-12">LSTM RNN Music Composition</h1>
        </div>
        <div id="navigation" class="row text-center">
            <nav class="col-sm-12">
                <a href="#Overview">Overview</a>
                <a href="#Goal">Goal</a>
                <a href="#Implementation">Implementation</a>
                <a href="#Listening Examples">Listening Examples</a>
                <a href="#Evaluation">Evaluation</a>
                <a href="#Conclusion">Conclusion</a>
                <a href="#Credits">Credits</a>
                <a href="#Links">Links</a>
            </nav>
        </div>
        <div id="DownloadThesis" class="row text-center">
            <h3 class="col-sm-12"><a href="Thesis_final01.pdf" target="_blank">Download Thesis</a></h3>
        </div>
    </header>
    <!--
    <div id="banner" class="jumbotron">
        <div class="container">
            <div class="row text-center">
                <h2>Composing a melody with<br>long-short term memory (LSTM) Recurrent Neural Networks</h2>
                <h3>!!! This Baby is under construction !!!</h3>
                <h3><a href="Thesis_final01.pdf" target="_blank">Download Thesis</a></h3>
            </div>
        </div>
    </div>
    -->
    
    <!-- Main Part Starts Here! -->
    <div class="container">
        <div class="row">
            <div class="col-md-1">
            </div>
            <div id="mainpart" class="col-md-10">
                
                
                
                <h1 id="Overview">Overview</h1>
                <p>This is a short overview about my Bachelor’s thesis I wrote about “Composing a melody with long-short term memory (LSTM) Recurrent Neural Networks” at the Chair for Data Processing at the Technical University Munich. For a more in-depth understanding of the topic you can read the whole <a href="Thesis_final01.pdf" target="_blank">thesis</a> following the link. The code that has been used to implement the LSTM Recurrent Neural Network can be found in my <a href="https://github.com/konstilackner/LSTM-RNN-Melody-Composer" target="_blank">Github repository</a>. Most interestingly are probably the listening examples of the Neural Network Compositions, which can be found <a href="#Listening Examples">further below</a>. Furthermore, the evaluation of the composed melodies plays an important role, in order to objectively asses the quality of the LSTM RNN composer and therefore be able to make a contribution to the research in this area.</p>
                
                
                
                <h1 id="Goal">Goal</h1>
                <p>The goal of this thesis was to implement a LSTM Recurrent Neural Network (LSTM RNN) that composes a melody to a given chord sequence. The compositional aims are that the melody sounds pleasantly to the listener and cannot be distinguished from human compositions. These two aims have been evaluated in a listening test with human subjects, which is further explained in the <a href="#Evaluation">evaluation section</a>.</p>
                
                
                
                <h1 id="Implementation">Implementation</h1>
                <p>For the training of the LSTM RNN chord/melody pairs of Beatles songs have been used, where the chords feed-forward through the network and the belonging melodies are the target values. So to say, the LSTM RNN learns which melodies fit to certain chord sequences and once a new chord sequence is presented to the network it should be able to predict which melody fits to this chord sequence.</p>
                <p>The training data consists of 68 different chord/melody pairs taken from 16 different Beatles songs. The chord/melody pairs have been created in MIDI format and are transformed into a piano roll matrix, consisting of ones if a note is “on” and zeroes if a note is “off”. The transformation process is more detailed in the <a href="Thesis_final01.pdf" target="_blank">thesis</a>.</p>
                <p>In order to reduce the computational costs, the LSTM RNN’s architecture has been restricted to twelve input nodes and 24 output nodes. Each node represents one pitch, meaning that chords that will feed-forward through the network need to be in the pitch range of an octave. The same goes for the melodies, which are available to the network at the output layer, thus need to be in the pitch range of two octaves. The number of hidden layers and nodes per hidden layer has been varied while conducting the experiments. For more detailed information, see the “Experiments” section of the <a href="Thesis_final01.pdf" target="_blank">thesis</a>.</p>
                <p><img src="images/LSTMRNNNetworkTopology.png" alt="If the picture does not load, please contact me via konstantinlackner@gmail.com" width="90%"></p>

                
                
                
                <h1 id="Listening Examples">Listening Examples</h1>
                <p>After conducting the experiments with several different Network architectures, a network with two hidden layers (9 nodes in the first hidden layer, 18 nodes in the second one) has been chosen as the most promising architecture to fulfill the compositional aims from above.</p>
                <p>Eight different chord sequences have been used to which the LSTM RNN composed the melodies. In addition, humans were asked to compose melodies to the same chord sequences in order to be able to evaluate the computer compositions. In the following you can listen the chord sequences, the computer compositions as well as the human compositions. It should be noted, that all compositions have been made in MIDI format, while a simple piano VST-instrument has been used as the sound engine.</p>
                <table style="width:80%" align="center">
                    <tr>
                        <td></td>
                        <td align="center"><b>Chords only</b></td>
                        <td align="center"><b>Computer compositions</b></td>
                        <td align="center"><b>Human compositions</b></td>
                    </tr>
                    <tr>
                        <td><b>1</b></td>
                        <td align="center"><audio controls><source src="audio/chord01.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/computer01.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/human01.mp3" type="audio/mpeg"></audio></td>
                    </tr>
                    <tr>
                        <td><b>2</b></td>
                        <td align="center"><audio controls><source src="audio/chord02.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/computer02.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/human02.mp3" type="audio/mpeg"></audio></td>
                    </tr>
                    <tr>
                        <td><b>3</b></td>
                        <td align="center"><audio controls><source src="audio/chord03.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/computer03.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/human03.mp3" type="audio/mpeg"></audio></td>
                    </tr>
                    <tr>
                        <td><b>4</b></td>
                        <td align="center"><audio controls><source src="audio/chord04.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/computer04.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/human04.mp3" type="audio/mpeg"></audio></td>
                    </tr>
                    <tr>
                        <td><b>5</b></td>
                        <td align="center"><audio controls><source src="audio/chord05.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/computer05.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/human05.mp3" type="audio/mpeg"></audio></td>
                    </tr>
                    <tr>
                        <td><b>6</b></td>
                        <td align="center"><audio controls><source src="audio/chord06.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/computer06.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/human06.mp3" type="audio/mpeg"></audio></td>
                    </tr>
                    <tr>
                        <td><b>7</b></td>
                        <td align="center"><audio controls><source src="audio/chord07.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/computer07.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/human07.mp3" type="audio/mpeg"></audio></td>
                    </tr>
                    <tr>
                        <td><b>8</b></td>
                        <td align="center"><audio controls><source src="audio/chord08.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/computer08.mp3" type="audio/mpeg"></audio></td>
                        <td align="center"><audio controls><source src="audio/human08.mp3" type="audio/mpeg"></audio></td>
                    </tr>
                </table>
                
                
                
                <h1 id="Evaluation">Evaluation</h1>
                <p>In order to be able to evaluate the compositional aims (1. The Melodies should sound pleasantly; 2. The melodies should be indistinguishable from human melodies) an online listening test with 109 human subjects has been conducted. The listening test has been divided into two parts.</p>
                <h3>Part One</h3>
                <p>The first part aims to evaluate whether the computer melodies sound pleasantly to the listener. The subjects were presented the computer composition as well as the human composition for each chord sequence and they were asked to indicate, which melody they like better. During the first part, the subjects haven’t been told, that some melodies have been composed by a computer.</p>
                <p><img src="images/ListeningTest_PartOne.png" alt="couldn't load file" width="60%"></p>
                <p><img src="images/Melodies01to08.jpg" alt="couldn't load file" width="55%"></p>
                <p>In about 73% of the cases the human melody was preferred over the computer composition, which indicates a clear preference for human melodies. Thus one can suggest that human melodies sound more pleasantly to the listener than the computer melodies. However, in more than one-fourth of the cases the subjects preferred the computer composition, which shows that a few computer melodies did sound indeed more pleasantly than the human compositions.</p>
                <h3>Part Two</h3>
                <p>The second part aims to evaluate whether the computer melodies can be distinguished from human melodies. Here, the subjects have been told that some melodies are composed by a computer. The subjects were presented all 16 melodies after each other (8 computer melodies, 8 human melodies) and were asked for each melody, if they think it was composed by a computer or by a human.</p>
                <p><img src="images/ListeningTest_PartTwo.png" alt="couldn't load file" width="60%"></p>
                <p><img src="images/ComputerMelodiesClassification.jpg" alt="If the picture does not load, please contact me via konstantinlackner@gmail.com" width="55%">
                    <img src="images/HumanMelodiesClassification.jpg" alt="If the picture does not load, please contact me via konstantinlackner@gmail.com" width="55%"></p>
                <p>Both human and computer melodies have been correctly classified in about 61% of the cases, giving a classification accuracy of 0.6164. This means that there is a distinguishable difference between human and computer compositions, even though this is a not very distinct difference, as 40% of the computer melodies have been falsely classified as human melodies. It has to be noted that the subjects were differently biased on the expectations about a computer composition. Some subjects noted in their feedback, that they expected computer melodies to be “almost perfect”, while others assumed that a computer is generally unable to compose music.</p>
                <p>For a more detailed explanation of the evaluation, see the “Evaluation” part of the <a href="Thesis_final01.pdf" target="_blank">thesis</a>.</p>
                
                
                
                <h1 id="Conclusion">Conclusion</h1>
                <p>The main goal for this thesis was to implement a long-short term memory Recurrent Neural Network, that composes melodies that sound pleasantly to the listener and cannot be distinguished from human melodies. As the evaluation of the computer compositions has shown, the LSTM RNN composed melodies that partly sounded pleasantly to the listener. However, in the majority of the cases the human compositions were preferred, thus the LSTM RNN did not fully succeed in fulfilling the first requirement. In addition, the computer compositions could be recognized as such in about 60% of the cases, making them distinguishable from human compositions. Still, in 40% of the cases the computer melodies were misclassified as human melodies. Overall the LSTM RNN did not succeed in completely fulfilling the main goals for this thesis, but it did in fact compose very interesting and nice sounding melodies at parts, that satisfy those goals.</p>
                <p>A final result is an implementation of a LSTM Recurrent Neural Network, that composes a melody to a given chord sequence, which, apart from any requirements of this thesis, can be used as a creative tool of inspiration for composers and music producers.</p>
                <p>If you have any questions about the thesis or want to discuss further developments of algorithmic music composition, feel free to contact me via <a href="mailto:konstantinlackner@gmail.com" target="_top">konstantinlackner@gmail.com</a>. I always appreciate feedback.</p>
                
                
                
                <h1 id="Credits">Credits</h1>
                <p>A big thanks to:</p>
                <ul>
                    <li>Thomas Volk, for supervising the thesis, the helpful and critical discussions and keeping me on track, when things didn’t want to work out in the beginning</li>
                    <li>Prof. Diepold, for giving me the opportunity to write about the topic of Algorithmic Composition</li>
                    <li>Douglas Eck, for sharing important insights at an early stage of the thesis</li>
                    <li>Bernat Fages, for sharing his thesis and code, which helped a lot during the implementation phase</li>
                    <li>To everyone who participated in the listening test. I love you all &#9786;</li>
                </ul>
                
                
                
                <h1 id="Links">Links</h1>
                <p>Here you can find a (non-comprehensive) list with links related to the topic:</p>
                <ul>
                    <li><a href="http://people.idsia.ch/~juergen/blues/" target="_blank">http://people.idsia.ch/~juergen/blues/</a></li>
                    <li><a href="https://github.com/bernatfp/LSTM-Composer" target="_blank">https://github.com/bernatfp/LSTM-Composer</a></li>
                    <li><a href="http://www.hexahedria.com/2015/08/03/composing-music-with-recurrent-neural-networks/" target="_blank">http://www.hexahedria.com/2015/08/03/composing-music-with-recurrent-neural-networks/</a></li>
                    <li><a href="http://www.brandmaier.de/alice/" target="_blank">http://www.brandmaier.de/alice/</a></li>
                    <li><a href="http://www.wise.io/tech/asking-rnn-and-ltsm-what-would-mozart-write" target="_blank">http://www.wise.io/tech/asking-rnn-and-ltsm-what-would-mozart-write</a></li>
                    <li><a href="https://highnoongmt.wordpress.com/2015/05/22/lisls-stis-recurrent-neural-networks-for-folk-music-generation/" target="_blank">https://highnoongmt.wordpress.com/2015/05/22/lisls-stis-recurrent-neural-networks-for-folk-music-generation/</a></li>
                    <li><a href="http://gitxiv.com/posts/WEoQCj8hxHz6vPxe6/gruv-algorithmic-music-generation-using-recurrent-neural" target="_blank">http://gitxiv.com/posts/WEoQCj8hxHz6vPxe6/gruv-algorithmic-music-generation-using-recurrent-neural</a></li>
                </ul>
                
            </div>
            <div class="col-md-1">
            </div>
            
        </div>
            
    </div>
    
    
    <footer class="container">
        <div class="row">
            <div class="col-sm-1"></div>
            <div id="footer" class="col-sm-10">
                <center>
                    <p>
                        <a href="mailto:konstantinlackner@gmail.com">&copy; 2016 Konstantin Lackner</a>
                        <a href="https://www.tum.de/" target="_blank"><img src="images/footer_tum.gif" alt="TUM Logo" style="height:50px"></a>
                        <a href="https://www.ldv.ei.tum.de/" target="_blank"> <img src="images/footer_ldv.png" alt="LDV Logo" style="height:60px"></a>
                        <a href="https://soundcloud.com/konchord" target="_blank"><img src="images/footer_soundcloud.jpg" alt="soundcloud.com/konchord" style="height:60px"></a>
                    </p>
                </center>
            </div>
            <div class="col-sm-1"></div>
        </div>
    </footer>
    
</body>
</html>